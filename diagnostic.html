<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸ªäººä¸»é¡µ Â· é™Œç­ï¼ˆè¯Šæ–­æ¨¡å¼ï¼‰</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,400;0,500;0,600;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Nunito', sans-serif; }
        body { background: #f0f4fa; display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }
        .diagnostic-card { max-width: 800px; width: 100%; background: white; border-radius: 30px; padding: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        h1 { color: #1e3a5f; margin-bottom: 20px; }
        .error-box { background: #fee; border-left: 6px solid #c00; padding: 20px; border-radius: 12px; margin-bottom: 20px; }
        .error-box h3 { color: #c00; margin-bottom: 10px; }
        pre { background: #f5f5f5; padding: 15px; border-radius: 8px; overflow-x: auto; }
        .btn { display: inline-block; background: #3a6ea5; color: white; padding: 10px 20px; border-radius: 30px; text-decoration: none; margin-top: 20px; }
        .btn:hover { background: #2e5a88; }
    </style>
</head>
<body>
    <div class="diagnostic-card" id="diagnostic">
        <h1>ğŸ”§ é…ç½®æ–‡ä»¶åŠ è½½è¯Šæ–­</h1>
        <div id="result">
            <p>æ­£åœ¨æ£€æŸ¥ config.js åŠ è½½çŠ¶æ€...</p>
        </div>
        <div style="margin-top: 30px;">
            <a href="config.js" target="_blank" class="btn">ç›´æ¥æ‰“å¼€ config.js æŸ¥çœ‹å†…å®¹</a>
            <button onclick="location.reload()" class="btn" style="background:#6c757d;">é‡æ–°è¯Šæ–­</button>
        </div>
    </div>

    <script>
        (function() {
            const resultDiv = document.getElementById('result');
            let scriptLoadSuccess = false;
            let scriptError = null;
            let syntaxError = null;

            // æ•è·å…¨å±€è¯­æ³•é”™è¯¯
            window.onerror = function(message, source, lineno, colno, error) {
                if (source && source.includes('config.js')) {
                    syntaxError = { message, source, lineno, colno, error };
                }
                // è¿”å› true é˜²æ­¢é»˜è®¤å¤„ç†
                return true;
            };

            // åŠ¨æ€åŠ è½½ config.js å¹¶ç›‘å¬åŠ è½½ç»“æœ
            const script = document.createElement('script');
            script.src = 'config.js?_t=' + Date.now(); // åŠ æ—¶é—´æˆ³é˜²ç¼“å­˜
            script.onload = function() {
                scriptLoadSuccess = true;
                // æ£€æŸ¥ window.siteConfig æ˜¯å¦å·²å®šä¹‰
                if (typeof window.siteConfig !== 'undefined') {
                    resultDiv.innerHTML = `
                        <div style="background:#efe; border-left:6px solid #0a0; padding:20px; border-radius:12px;">
                            <h3 style="color:#0a0;">âœ… é…ç½®æ–‡ä»¶åŠ è½½æˆåŠŸï¼</h3>
                            <p><strong>window.siteConfig</strong> å·²å®šä¹‰ï¼Œé¡µé¢å°†æ­£å¸¸æ˜¾ç¤ºã€‚</p>
                            <p>å³å°†è·³è½¬è‡³ä¸»é¡µ...</p>
                        </div>
                    `;
                    // å»¶è¿Ÿè·³è½¬å›æ­£å¸¸ä¸»é¡µï¼ˆæ‚¨å¯ä»¥å°†ä¸‹é¢çš„ URL æ”¹ä¸ºæ‚¨çš„å®é™…ä¸»é¡µï¼‰
                    setTimeout(() => {
                        // è¿™é‡Œå‡è®¾æ‚¨çš„æ­£å¸¸ä¸»é¡µå°±æ˜¯å½“å‰é¡µé¢ï¼Œä½†ç§»é™¤äº†è¯Šæ–­è„šæœ¬
                        // å®é™…ä½¿ç”¨æ—¶å¯ä»¥é‡å®šå‘åˆ°ä¸å¸¦è¯Šæ–­çš„ç‰ˆæœ¬ï¼Œæˆ–è€…ç›´æ¥æ¸²æŸ“Vue
                        location.href = 'index.html'; // è¯·æ ¹æ®å®é™…æƒ…å†µä¿®æ”¹
                    }, 2000);
                } else {
                    resultDiv.innerHTML = `
                        <div class="error-box">
                            <h3>âš ï¸ æ–‡ä»¶åŠ è½½æˆåŠŸï¼Œä½† window.siteConfig æœªå®šä¹‰</h3>
                            <p><strong>åŸå› ï¼š</strong> config.js æ²¡æœ‰æ­£ç¡®è®¾ç½® <code>window.siteConfig</code> å¯¹è±¡ã€‚</p>
                            <p>è¯·æ£€æŸ¥ config.js æ–‡ä»¶å†…å®¹ï¼Œç¡®ä¿æœ€åæœ‰ç±»ä¼¼è¿™æ ·çš„ä»£ç ï¼š</p>
                            <pre>window.siteConfig = { ... };</pre>
                            <p>å½“å‰ window.siteConfig å€¼ä¸ºï¼š<code>${window.siteConfig}</code></p>
                        </div>
                    `;
                }
            };
            script.onerror = function(ev) {
                scriptLoadSuccess = false;
                scriptError = ev;
                let errorDetail = '';
                // å°è¯•åŒºåˆ† 404 å’Œå…¶ä»–é”™è¯¯
                fetch(script.src, { method: 'HEAD' }).then(res => {
                    if (res.status === 404) {
                        errorDetail = 'æ–‡ä»¶ä¸å­˜åœ¨ (404)';
                    } else {
                        errorDetail = `HTTP çŠ¶æ€ç : ${res.status}`;
                    }
                }).catch(() => {
                    errorDetail = 'æ— æ³•è®¿é—®æ–‡ä»¶ï¼ˆå¯èƒ½è·¨åŸŸæˆ–ç½‘ç»œé—®é¢˜ï¼‰';
                }).finally(() => {
                    resultDiv.innerHTML = `
                        <div class="error-box">
                            <h3>âŒ é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥</h3>
                            <p><strong>é”™è¯¯ç±»å‹ï¼š</strong> è„šæœ¬åŠ è½½é”™è¯¯</p>
                            <p><strong>è¯¦æƒ…ï¼š</strong> ${errorDetail}</p>
                            <p><strong>å»ºè®®ï¼š</strong></p>
                            <ul>
                                <li>ç¡®è®¤ <code>config.js</code> æ˜¯å¦ä¸å½“å‰ HTML æ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹ã€‚</li>
                                <li>æ£€æŸ¥æ–‡ä»¶åå¤§å°å†™æ˜¯å¦å®Œå…¨ä¸€è‡´ï¼ˆåŒ…æ‹¬æ‰©å±•åï¼‰ã€‚</li>
                                <li>å¦‚æœä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨ï¼Œç¡®ä¿æ–‡ä»¶å¯è®¿é—®ã€‚</li>
                            </ul>
                        </div>
                    `;
                });
            };

            // å°†è„šæœ¬æ’å…¥é¡µé¢ï¼Œå¼€å§‹åŠ è½½
            document.head.appendChild(script);

            // è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œå¦‚æœé•¿æ—¶é—´æ²¡ç»“æœï¼ˆæ¯”å¦‚è¯­æ³•é”™è¯¯å¯¼è‡´ onload æœªè§¦å‘ï¼‰
            setTimeout(() => {
                if (!scriptLoadSuccess && !syntaxError) {
                    // å¯èƒ½è¯­æ³•é”™è¯¯å¯¼è‡´ onload æœªè§¦å‘ï¼Œä½† onerror ä¹Ÿæœªè§¦å‘ï¼Ÿæ­¤æ—¶æ£€æŸ¥è¯­æ³•é”™è¯¯æ•è·
                    if (syntaxError) {
                        resultDiv.innerHTML = `
                            <div class="error-box">
                                <h3>âŒ é…ç½®æ–‡ä»¶å­˜åœ¨è¯­æ³•é”™è¯¯</h3>
                                <p><strong>é”™è¯¯ä¿¡æ¯ï¼š</strong> ${syntaxError.message}</p>
                                <p><strong>ä½ç½®ï¼š</strong> ç¬¬ ${syntaxError.lineno} è¡Œï¼Œç¬¬ ${syntaxError.colno} åˆ—</p>
                                <p><strong>å»ºè®®ï¼š</strong> æ ¹æ®ä¸Šé¢çš„é”™è¯¯ä¿¡æ¯ä¿®æ­£ config.js ä¸­çš„è¯­æ³•é”™è¯¯ã€‚</p>
                            </div>
                        `;
                    } else if (!scriptLoadSuccess) {
                        resultDiv.innerHTML = `
                            <div class="error-box">
                                <h3>â³ åŠ è½½è¶…æ—¶</h3>
                                <p>è„šæœ¬åŠ è½½è¶…è¿‡ 3 ç§’æœªå“åº”ï¼Œå¯èƒ½æ˜¯æ–‡ä»¶è¿‡å¤§æˆ–ç½‘ç»œé—®é¢˜ã€‚</p>
                                <p>è¯·å°è¯•ç›´æ¥æ‰“å¼€ <a href="config.js" target="_blank">config.js</a> æŸ¥çœ‹æ˜¯å¦èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚</p>
                            </div>
                        `;
                    }
                }
            }, 3000);
        })();
    </script>
</body>
</html>